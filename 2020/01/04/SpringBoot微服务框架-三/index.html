<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-center-atom.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">


  <link rel="manifest" href="/images/manifest.json">


  <meta name="msapplication-config" content="/images/browserconfig.xml" />



  <meta name="keywords" content="SpringBoot," />










<meta name="description" content="配置debug=true，控制台打印自动配置报告日志日志框架   日志门面(日志的抽象层) 日志实现    slf4j Log4j jul(java.util.logging) log4j2 logback    springBoot底层是Spring框架，Spring默认的是JCL(commons-loggin.jar ); springBoot选用slf4j和logback  slf4j的使用">
<meta name="keywords" content="SpringBoot">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringBoot微服务框架(三)">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2020&#x2F;01&#x2F;04&#x2F;SpringBoot%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6-%E4%B8%89&#x2F;index.html">
<meta property="og:site_name" content="卓尔不凡">
<meta property="og:description" content="配置debug=true，控制台打印自动配置报告日志日志框架   日志门面(日志的抽象层) 日志实现    slf4j Log4j jul(java.util.logging) log4j2 logback    springBoot底层是Spring框架，Spring默认的是JCL(commons-loggin.jar ); springBoot选用slf4j和logback  slf4j的使用">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http:&#x2F;&#x2F;www.slf4j.org&#x2F;images&#x2F;concrete-bindings.png">
<meta property="og:image" content="http:&#x2F;&#x2F;www.slf4j.org&#x2F;images&#x2F;legacy.png">
<meta property="og:updated_time" content="2020-01-04T07:36:45.619Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;www.slf4j.org&#x2F;images&#x2F;concrete-bindings.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/01/04/SpringBoot微服务框架-三/"/>





  <title>SpringBoot微服务框架(三) | 卓尔不凡</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
	<a href="https://github.com/botbotji" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">卓尔不凡</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">师夷长技以制夷</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule" rel="section">
            
            日程表
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" target="_blank" rel="noopener" class="popup-trigger">
          
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/04/SpringBoot%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6-%E4%B8%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="卓尔不凡">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="卓尔不凡">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">SpringBoot微服务框架(三)</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-01-04T15:17:58+08:00">
                2020-01-04
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/01/04/SpringBoot%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6-%E4%B8%89/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count gitment-comments-count" data-xid="/2020/01/04/SpringBoot%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6-%E4%B8%89/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  6.2k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  30
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="配置debug-true，控制台打印自动配置报告"><a href="#配置debug-true，控制台打印自动配置报告" class="headerlink" title="配置debug=true，控制台打印自动配置报告"></a>配置debug=true，控制台打印自动配置报告</h3><h3 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h3><h4 id="日志框架"><a href="#日志框架" class="headerlink" title="日志框架"></a>日志框架</h4><table>
<thead>
<tr>
<th>日志门面(日志的抽象层)</th>
<th align="center">日志实现</th>
</tr>
</thead>
<tbody><tr>
<td>slf4j</td>
<td align="center">Log4j jul(java.util.logging) log4j2 logback</td>
</tr>
</tbody></table>
<ul>
<li>springBoot底层是Spring框架，Spring默认的是JCL(commons-loggin.jar );</li>
<li>springBoot选用slf4j和logback</li>
</ul>
<h3 id="slf4j的使用"><a href="#slf4j的使用" class="headerlink" title="slf4j的使用"></a>slf4j的使用</h3><ul>
<li>开发的时候，日志方法的调用，不应该直接调用日志的实现类，<br>而是调用日志抽象层里面的方法;</li>
</ul>
<ol>
<li>导包slf4j的jar包和logback实现的jar包；<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import org.slf4j.Logger;</span><br><span class="line">import org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Main &#123;</span><br><span class="line">   final Logger logger = <span class="module-access"><span class="module"><span class="identifier">LoggerFactory</span>.</span></span>get<span class="constructor">Logger(<span class="params">getClass</span>()</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 日志操作对象</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   Logger logger = <span class="module-access"><span class="module"><span class="identifier">LoggerFactory</span>.</span></span>get<span class="constructor">Logger(CommonController.<span class="params">class</span>)</span>;</span><br></pre></td></tr></table></figure>
图示:<br><img src="http://www.slf4j.org/images/concrete-bindings.png" alt="slf4j"></li>
</ol>
<ul>
<li>每一个日志的实现框架都有自己的配置文件。使用slf4j以后，配置文件还是做成日志实现框架自己本身的配置文件；</li>
<li>遗留问题<ul>
<li>SpringBoot(slf4j+logback)</li>
<li>Spring(commons-logging)</li>
<li>Hibernate(jboss-logging).等</li>
</ul>
</li>
</ul>
<ul>
<li>统一日志记录，即使是别的框架和我一起使用slf4j+logback进行输出<br>图示:<br><img src="http://www.slf4j.org/images/legacy.png" alt="统一日志记录"><h5 id="如何在系统中所有的日志都统一到slf4j；"><a href="#如何在系统中所有的日志都统一到slf4j；" class="headerlink" title="如何在系统中所有的日志都统一到slf4j；"></a>如何在系统中所有的日志都统一到slf4j；</h5><ul>
<li>1.将系统中其他的日志框架先排除；</li>
<li>2.用中间包类替换原有的日志框架；</li>
<li>3.我们导入slf4j其他的实现<h3 id="springBoot日志关系"><a href="#springBoot日志关系" class="headerlink" title="springBoot日志关系"></a>springBoot日志关系</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<ul>
<li>springBoot使用他来做日志功能：<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>总结：<ul>
<li>1.SpringBoot底层也是使用slf4j+logback的方式记录日志</li>
<li>2.SpringBoot也把替他的日志都替换成了slf4j</li>
<li>3.中间替换包？<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-to-slf4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jul-to-slf4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.29<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>如果我们要引入其他框架？一定要把这个框架的默认依赖移除掉<br>Spring框架日志文件（commons-logging）<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 排除 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>注意：SpringBoot能自动适配所有的日志，而且底层使用slfj+logback的方式记录日志，引入其他框架的时候，只需要把这个框架的依赖日志排除</li>
<li>加上Log4j2日志框架依赖<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h4 id="测试案例"><a href="#测试案例" class="headerlink" title="测试案例"></a>测试案例</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">package</span> com.zhao;</span><br><span class="line"> <span class="keyword">import</span> org.junit.jupiter.api.<span class="type">Test</span>;</span><br><span class="line"> <span class="keyword">import</span> org.junit.runner.<span class="type">RunWith</span>;</span><br><span class="line"> <span class="keyword">import</span> org.slf4j.<span class="type">Logger</span>;</span><br><span class="line"> <span class="keyword">import</span> org.springframework.boot.test.context.<span class="type">SpringBootTest</span>;</span><br><span class="line"> <span class="keyword">import</span> org.springframework.test.context.junit4.<span class="type">SpringRunner</span>;</span><br><span class="line"> <span class="keyword">import</span> org.slf4j.<span class="type">LoggerFactory</span>;</span><br><span class="line"> &lt;!-- 注意：</span><br><span class="line"> 添加注解：<span class="meta">@RunWith</span>(<span class="type">SpringRunner</span><span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"> <span class="title">导入的包：org</span>.<span class="title">springframework</span>.<span class="title">test</span>.<span class="title">context</span>.<span class="title">junit4</span>.<span class="title">SpringRunner</span></span>;</span><br><span class="line"> 添加记录器工厂  <span class="type">LoggerFactory</span> </span><br><span class="line"> 导入的包：org.slf4j.<span class="type">LoggerFactory</span>;--&gt;</span><br><span class="line"> <span class="meta">@RunWith</span>(<span class="type">SpringRunner</span><span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"> <span class="title">@SpringBootTest</span></span></span><br><span class="line"><span class="class"> <span class="title">class</span> <span class="title">DemoTest03ApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//记录器</span></span><br><span class="line">	<span class="keyword">final</span> <span class="type">Logger</span> logger = <span class="type">LoggerFactory</span>.getLogger(getClass());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	void contextLoads() &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//日志级别</span></span><br><span class="line">		<span class="comment">//由高到底 trace&lt;debug&lt;info&lt;wran&lt;error</span></span><br><span class="line"></span><br><span class="line">		logger.trace(<span class="string">"这是trace日志。。。。"</span>);</span><br><span class="line">		logger.debug(<span class="string">"这是debug调试日志。。。。"</span>);</span><br><span class="line">		logger.info(<span class="string">"这是info日志。。。。。"</span>);</span><br><span class="line">		logger.warn(<span class="string">"这是警告wran日志。。。。"</span>);</span><br><span class="line">		<span class="comment">//SpringBoot默认Info级别</span></span><br><span class="line">		<span class="comment">//可以调正输出的日志级别：日志就只会在这个级别以后的级别高级别生效</span></span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		 *trace：追踪，就是程序推进一下，可以写个trace输出</span></span><br><span class="line"><span class="comment">		 *debug：调试，一般作为最低级别，trace基本不用。</span></span><br><span class="line"><span class="comment">		 *info：输出重要的信息，使用较多</span></span><br><span class="line"><span class="comment">		 *warn：警告，有些信息不是错误信息，但也要给程序员一些提示。</span></span><br><span class="line"><span class="comment">		 *error：错误信息。用的也很多。</span></span><br><span class="line"><span class="comment">		 *fatal：致命错误。</span></span><br><span class="line"><span class="comment">		*/</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="指定日志的输出位置"><a href="#指定日志的输出位置" class="headerlink" title="指定日志的输出位置"></a>指定日志的输出位置</h3><ul>
<li>properties文件中配置<br>logging.level.com.atguigu=trace<br>第一种方式：<br>//在当前磁盘的根路径下创建spring文件夹和里面的log文件夹，默认生成spring.log日志文件<br>logging.path=/spring/log<br>第二种方式：<br>//当前项目下生成springboot.log日志文件<br>loging.file=springboot.log<br>第三种方式：<br>//指定路径下生成springboot.log日志文件<br>loging.file=G:/springboot.log<br>第四种方式：<br>//在控制台输出日志的格式<br>logging.pattern.console=%d{yyyy-MM-dd HH-mm-ss.SSS} [%thread] %-5level %logger{50} - %msg%n<br>// 指定文件中日志的输出格式<br>logging.pattern.file=<h3 id="日志的输出格式："><a href="#日志的输出格式：" class="headerlink" title="日志的输出格式："></a>日志的输出格式：</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">%<span class="selector-tag">d</span></span>表示日期时间</span><br><span class="line"><span class="tag">%<span class="selector-tag">thread</span></span>表示当前线程</span><br><span class="line"><span class="tag">%</span>-5level：级别从左显示5个字符宽度</span><br><span class="line"><span class="tag">%<span class="selector-tag">logger</span>&#123;50&#125;</span>：表示logger&#123;50&#125;名字最长50个字符，否则按照据点分割；</span><br><span class="line"><span class="tag">%<span class="selector-tag">msg</span></span>：日志消息</span><br><span class="line"><span class="tag">%<span class="selector-tag">n</span></span>：换行符</span><br><span class="line"><span class="tag">%<span class="selector-tag">d</span>&#123;yyyy-MM-dd HH-mm-ss.SSS&#125;</span> [%thread] %-5level %logger&#123;50&#125; - %msg%n</span><br></pre></td></tr></table></figure></li>
<li>自定义日志</li>
</ul>
<table>
<thead>
<tr>
<th>logging System（日志框架)</th>
<th align="center">Customization</th>
</tr>
</thead>
<tbody><tr>
<td>logback</td>
<td align="center">logback-spring.xml , logback-spring.groovy , logback.xml or logback.groovy</td>
</tr>
<tr>
<td>Logf4j</td>
<td align="center">log4j-spring.xml or logf4j.xml</td>
</tr>
<tr>
<td>JDK(java util Logging)</td>
<td align="center">logging.properties</td>
</tr>
</tbody></table>
<ul>
<li>logback.xml:直接被日志框架识别了</li>
<li>ligback-spring.xml：日志框架就不直接加载日志的配置项，由SpringBoot解析日志配置，可以使用高级Profile功能，否则会报错</li>
<li>高级功能<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">springProfile</span> <span class="attr">name</span>=<span class="string">"dev"</span>&gt;</span></span><br><span class="line">  可以直接指定某段配置只有某个环境下生效</span><br><span class="line"><span class="tag">&lt;/<span class="name">springProfile</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>如果使用logback.xml作为日志配置文件，还要使用profile功能，会有以下报错<br>  no applicable action for [springProfile 888]</li>
</ul>
<h3 id="切换日志框架"><a href="#切换日志框架" class="headerlink" title="切换日志框架"></a>切换日志框架</h3><ul>
<li><p>可以按照slf4j的日志适配图，进行相关的切换</p>
<h3 id="web开发"><a href="#web开发" class="headerlink" title="web开发"></a>web开发</h3></li>
<li><p>SpringBoot对静态资源的映射规则（WebMvcAutoConfiguration）</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//访问路径配置</span></span><br><span class="line"> public void add<span class="constructor">ResourceHandlers(ResourceHandlerRegistry <span class="params">registry</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!this.resourceProperties.is<span class="constructor">AddMappings()</span>) &#123;</span><br><span class="line">                logger.debug(<span class="string">"Default resource handling disabled"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                Duration cachePeriod = this.resourceProperties.get<span class="constructor">Cache()</span>.get<span class="constructor">Period()</span>;</span><br><span class="line">                CacheControl cacheControl = this.resourceProperties.get<span class="constructor">Cache()</span>.get<span class="constructor">Cachecontrol()</span>.<span class="keyword">to</span><span class="constructor">HttpCacheControl()</span>;</span><br><span class="line">                <span class="keyword">if</span> (!registry.has<span class="constructor">MappingForPattern(<span class="string">"/webjars/**"</span>)</span>) &#123;</span><br><span class="line">                    this.customize<span class="constructor">ResourceHandlerRegistration(<span class="params">registry</span>.<span class="params">addResourceHandler</span>(<span class="params">new</span> String[]&#123;<span class="string">"/webjars/**"</span>&#125;)</span>.add<span class="constructor">ResourceLocations(<span class="params">new</span> String[]&#123;<span class="string">"classpath:/META-INF/resources/webjars/"</span>&#125;)</span>.set<span class="constructor">CachePeriod(<span class="params">this</span>.<span class="params">getSeconds</span>(<span class="params">cachePeriod</span>)</span>).set<span class="constructor">CacheControl(<span class="params">cacheControl</span>)</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                String staticPathPattern = this.mvcProperties.get<span class="constructor">StaticPathPattern()</span>;</span><br><span class="line">                <span class="keyword">if</span> (!registry.has<span class="constructor">MappingForPattern(<span class="params">staticPathPattern</span>)</span>) &#123;</span><br><span class="line">                    this.customize<span class="constructor">ResourceHandlerRegistration(<span class="params">registry</span>.<span class="params">addResourceHandler</span>(<span class="params">new</span> String[]&#123;<span class="params">staticPathPattern</span>&#125;)</span>.add<span class="constructor">ResourceLocations(WebMvcAutoConfiguration.<span class="params">getResourceLocations</span>(<span class="params">this</span>.<span class="params">resourceProperties</span>.<span class="params">getStaticLocations</span>()</span>)).set<span class="constructor">CachePeriod(<span class="params">this</span>.<span class="params">getSeconds</span>(<span class="params">cachePeriod</span>)</span>).set<span class="constructor">CacheControl(<span class="params">cacheControl</span>)</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//首页配置</span></span><br><span class="line">         @Bean</span><br><span class="line">        public WelcomePageHandlerMapping welcome<span class="constructor">PageHandlerMapping(ApplicationContext <span class="params">applicationContext</span>, FormattingConversionService <span class="params">mvcConversionService</span>, ResourceUrlProvider <span class="params">mvcResourceUrlProvider</span>)</span> &#123;</span><br><span class="line">            WelcomePageHandlerMapping welcomePageHandlerMapping = <span class="keyword">new</span> <span class="constructor">WelcomePageHandlerMapping(<span class="params">new</span> TemplateAvailabilityProviders(<span class="params">applicationContext</span>)</span>, applicationContext, this.get<span class="constructor">WelcomePage()</span>, this.mvcProperties.get<span class="constructor">StaticPathPattern()</span>);</span><br><span class="line">            welcomePageHandlerMapping.set<span class="constructor">Interceptors(<span class="params">this</span>.<span class="params">getInterceptors</span>(<span class="params">mvcConversionService</span>, <span class="params">mvcResourceUrlProvider</span>)</span>);</span><br><span class="line">            return welcomePageHandlerMapping;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>1.所有/webjars/**，都去classpath:/META-INF/resources/webjars/这里找资源<br>webjars：以jar包的方式引入静态资源；<br>网站<a href="http://www.webjars.org" target="_blank" rel="noopener">www.webjars.org</a><br>在pom.xml文件中引入webjars依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	<span class="comment">&lt;!--引入Jquery的Webjar--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.webjars<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jquery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>访问的时候只需要写webjars下面的资源名称即可<br>下面在<a href="http://localhost:8080/webjars/jquery/3.3.1/jquery.js就可访问的到" target="_blank" rel="noopener">http://localhost:8080/webjars/jquery/3.3.1/jquery.js就可访问的到</a></p>
</li>
<li><p>2.”/**”访问当前项目的任何资源(静态资源的文件夹)</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span></span><br><span class="line"> <span class="keyword">String</span>[] CLASSPATH_RESOURCE_LOCATIONS = <span class="keyword">new</span> <span class="keyword">String</span>[]&#123;</span><br><span class="line">   <span class="string">"classpath:/META-INF/resources/"</span>, </span><br><span class="line">   <span class="string">"classpath:/resources/"</span>, </span><br><span class="line">   <span class="string">"classpath:/static/"</span>, </span><br><span class="line">   <span class="string">"classpath:/public/"</span>&#125;;</span><br></pre></td></tr></table></figure></li>
<li><ol start="3">
<li>首页：静态资源文件夹下的所有index.html页面，被”/**”映射<br>localhost:8080/   找到index页面</li>
</ol>
</li>
<li><p>4.图标：所有**/favicon.ico都在静态资源文件夹下找；</p>
<h3 id="静态文件夹配置"><a href="#静态文件夹配置" class="headerlink" title="静态文件夹配置"></a>静态文件夹配置</h3></li>
<li><p>定义静态文件夹SpringBoot默认的静态文件夹不生效</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#数组</span><br><span class="line">spring.resources.<span class="keyword">static</span>-locations=<span class="keyword">classpath</span>:<span class="regexp">/webapp/</span>,<span class="keyword">classpath</span>:<span class="regexp">/page/</span></span><br></pre></td></tr></table></figure>
<h3 id="模板引擎Thymeleaf"><a href="#模板引擎Thymeleaf" class="headerlink" title="模板引擎Thymeleaf"></a>模板引擎Thymeleaf</h3></li>
<li><p>1.引入模板引擎thymeleaf：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!--引入Thymeleaf模块引擎--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>2.Thymeleaf使用和语法</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">@ConfigurationProperties(</span><br><span class="line">   prefix = <span class="string">"spring.thymeleaf"</span></span><br><span class="line">)</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Charset DEFAULT_ENCODING;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> DEFAULT_PREFIX = <span class="string">"classpath:/templates/"</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> DEFAULT_SUFFIX = <span class="string">".html"</span>;</span><br><span class="line">   <span class="keyword">private</span> <span class="built_in">boolean</span> checkTemplate = <span class="keyword">true</span>;</span><br><span class="line">   <span class="keyword">private</span> <span class="built_in">boolean</span> checkTemplateLocation = <span class="keyword">true</span>;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">String</span> prefix = <span class="string">"classpath:/templates/"</span>;</span><br><span class="line">   <span class="comment">//只要我们把Html页面放在classparh：/templates/下就可以自动渲染渲染</span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">String</span> suffix = <span class="string">".html"</span>;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">String</span> mode = <span class="string">"HTML"</span>;</span><br><span class="line">   <span class="keyword">private</span> Charset encoding;</span><br><span class="line">   <span class="keyword">private</span> <span class="built_in">boolean</span> cache;</span><br><span class="line">   <span class="keyword">private</span> Integer templateResolverOrder;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">String</span>[] viewNames;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">String</span>[] excludedViewNames;</span><br><span class="line">   <span class="keyword">private</span> <span class="built_in">boolean</span> enableSpringElCompiler;</span><br><span class="line">   <span class="keyword">private</span> <span class="built_in">boolean</span> renderHiddenMarkersBeforeCheckboxes;</span><br><span class="line">   <span class="keyword">private</span> <span class="built_in">boolean</span> enabled;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> ThymeleafProperties.Servlet servlet;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> ThymeleafProperties.Reactive reactive;</span><br></pre></td></tr></table></figure>
<h3 id="Html文件位置在templates文件夹下"><a href="#Html文件位置在templates文件夹下" class="headerlink" title="Html文件位置在templates文件夹下"></a>Html文件位置在templates文件夹下</h3></li>
<li><p>1.导入Thymeleaf名称空间xmlns:th=”<a href="http://www.thymeleaf.org&quot;" target="_blank" rel="noopener">http://www.thymeleaf.org&quot;</a></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;html <span class="attribute">lang</span>=<span class="string">"en"</span> xmlns:<span class="attribute">th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>2.不经过控制层controller不显示数据，只显示前台页面有的数据</p>
</li>
<li><p>3.语法规则</p>
<ul>
<li>3.1 th:text;改变当前元素的文本内容<pre><code>th:任意html属性，来替换原生属性的值</code></pre></li>
</ul>
</li>
<li><p>4.表达式</p>
<ul>
<li>4.1 语法<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Simple</span> expressions:(表达式语法)</span><br><span class="line">      <span class="type">Variable</span> <span class="type">Expressions</span>: $<span class="meta">&#123;...&#125;</span> 获取变量值：<span class="type">OGNL</span></span><br><span class="line">               <span class="number">1</span>. 获取对象的属性，调用方法</span><br><span class="line">               <span class="number">2</span>. 使用内置的基本对象</span><br><span class="line">                  <span class="comment">#ctx : the context object. 当前上下文文对象</span></span><br><span class="line">                  <span class="comment">#vars: the context variables.  当前上下文变量值</span></span><br><span class="line">                  <span class="comment">#locale : the context locale.  当前上下文区域信息</span></span><br><span class="line">                  <span class="comment">#request : (only in Web Contexts) the HttpServletRequest object. </span></span><br><span class="line">                  <span class="comment">#response : (only in Web Contexts) the HttpServletResponse object.</span></span><br><span class="line">                  <span class="comment">#session : (only in Web Contexts) the HttpSession object.</span></span><br><span class="line">                  <span class="comment">#servletContext : (only in Web Contexts) the ServletContext object.</span></span><br><span class="line">                <span class="number">3</span>. 内置工具对象</span><br><span class="line">                    <span class="comment">#execInfo : information about the template  being processed.</span></span><br><span class="line">                    <span class="comment">#messages : methods for obtaining externalized messages inside variables expressions, in the same way as they</span></span><br><span class="line">                    would be obtained <span class="keyword">using</span> <span class="comment">#&#123;…&#125; syntax.</span></span><br><span class="line">                    <span class="comment">#uris : methods for escaping parts of URLs/URIs</span></span><br><span class="line">                    <span class="type">Page</span> <span class="number">20</span> <span class="keyword">of</span> <span class="number">106</span></span><br><span class="line">                    <span class="comment">#conversions : methods for executing the configured conversion service (if any).</span></span><br><span class="line">                    <span class="comment">#dates : methods for java.util.Date objects: formatting, component extraction, etc.</span></span><br><span class="line">                    <span class="comment">#calendars : analogous to #dates , but for java.util.Calendar objects.</span></span><br><span class="line">                    <span class="comment">#numbers : methods for formatting numeric objects.</span></span><br><span class="line">                    <span class="comment">#strings : methods for String objects: contains, startsWith, prepending/appending, etc.</span></span><br><span class="line">                    <span class="comment">#objects : methods for objects in general.</span></span><br><span class="line">                    <span class="comment">#bools : methods for boolean evaluation.</span></span><br><span class="line">                    <span class="comment">#arrays : methods for arrays.</span></span><br><span class="line">                    <span class="comment">#lists : methods for lists.</span></span><br><span class="line">                    <span class="comment">#sets : methods for sets.</span></span><br><span class="line">                    <span class="comment">#maps : methods for maps.</span></span><br><span class="line">                    <span class="comment">#aggregates : methods for creating aggregates on arrays or collections.</span></span><br><span class="line">                    <span class="comment">#ids : methods for dealing with id attributes that might be repeated (for example, as a result of an iteration).</span></span><br><span class="line"></span><br><span class="line">      <span class="type">Selection</span> <span class="type">Variable</span> <span class="type">Expressions</span>: *<span class="meta">&#123;...&#125;</span> 变量选择表达式</span><br><span class="line">      和$&#123;&#125;在功能上是一样的</span><br><span class="line">      补充：配合th:<span class="keyword">object</span>=<span class="string">"$&#123;session.user&#125;"</span> 使用 th:text=<span class="string">"*&#123;name&#125;"</span>  *相当于$&#123;session.user&#125;</span><br><span class="line">      &lt;<span class="keyword">div</span> th:<span class="keyword">object</span>=<span class="string">"$&#123;session.user&#125;"</span>&gt;</span><br><span class="line">          &lt;p&gt;<span class="type">Name</span>: &lt;span th:text=<span class="string">"*&#123;firstName&#125;"</span>&gt;<span class="type">Sebastian</span>&lt;/span&gt;.&lt;/p&gt;</span><br><span class="line">          &lt;p&gt;<span class="type">Surname</span>: &lt;span th:text=<span class="string">"*&#123;lastName&#125;"</span>&gt;<span class="type">Pepper</span>&lt;/span&gt;.&lt;/p&gt;</span><br><span class="line">      &lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">      <span class="type">Message</span> <span class="type">Expressions</span>: <span class="comment">#&#123;...&#125; 获取国际化内容</span></span><br><span class="line">      <span class="type">Link</span> <span class="type">URL</span> <span class="type">Expressions</span>: @<span class="meta">&#123;...&#125;</span> 定义url链接</span><br><span class="line">      <span class="type">Fragment</span> <span class="type">Expressions</span>: ~<span class="meta">&#123;...&#125;</span> 片段引用表达式</span><br><span class="line"><span class="type">Literals</span>：(字面量)</span><br><span class="line">    <span class="type">Text</span> literals: 'one text' , '<span class="type">Another</span> one!' ,…</span><br><span class="line">    <span class="type">Number</span> literals: <span class="number">0</span> , <span class="number">34</span> , <span class="number">3</span>.<span class="number">0</span> , <span class="number">12</span>.<span class="number">3</span> ,…</span><br><span class="line">    <span class="type">Boolean</span> literals: <span class="literal">true</span> , <span class="literal">false</span></span><br><span class="line">    <span class="type">Null</span> literal: null</span><br><span class="line">    <span class="type">Literal</span> tokens: one , sometext , main ,…</span><br><span class="line"><span class="type">Text</span> operations:(文本操作)</span><br><span class="line">    <span class="type">String</span> concatenation: +</span><br><span class="line">    <span class="type">Literal</span> substitutions: |<span class="type">The</span> name <span class="keyword">is</span> $&#123;name&#125;|</span><br><span class="line"><span class="type">Arithmetic</span> operations:</span><br><span class="line">    <span class="type">Binary</span> operators: + , - , * , / , %</span><br><span class="line">    <span class="type">Minus</span> sign (unary operator): -</span><br><span class="line"><span class="type">Boolean</span> operations:（布尔运算）</span><br><span class="line">    <span class="type">Binary</span> operators: <span class="keyword">and</span> , <span class="keyword">or</span></span><br><span class="line">    <span class="type">Boolean</span> negation (unary operator): ! , <span class="keyword">not</span></span><br><span class="line"><span class="type">Comparisons</span> <span class="keyword">and</span> equality:（比较运算）</span><br><span class="line">    <span class="type">Comparators</span>: &gt; , &lt; , &gt;= , &lt;= ( gt , lt , ge , le )</span><br><span class="line">    <span class="type">Equality</span> operators: == , != ( eq , ne )</span><br><span class="line"><span class="type">Conditional</span> operators:(条件运算)</span><br><span class="line">    <span class="type">If</span>-then: (<span class="keyword">if</span>) ? (then)</span><br><span class="line">    <span class="type">If</span>-then-<span class="keyword">else</span>: (<span class="keyword">if</span>) ? (then) : (<span class="keyword">else</span>)</span><br><span class="line">    <span class="type">Default</span>: (value) ?: (defaultvalue)</span><br><span class="line"><span class="type">Special</span> tokens:</span><br><span class="line">    <span class="type">Page</span> <span class="number">17</span> <span class="keyword">of</span> <span class="number">106</span></span><br><span class="line">    <span class="type">No</span>-<span class="type">Operation</span>: _</span><br></pre></td></tr></table></figure>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3></li>
<li>1.html代码<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE html&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="comment">&lt;!--导入thymelesf名称空间作用语法提示</span></span></span><br><span class="line"><span class="xml">  xmlns:th="http://www.thymeleaf.org"--&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>成佛那个！<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- th:text="$</span></span><span class="template-variable">&#123;&#125;</span><span class="xml"><span class="comment">" 件div里面的文件内容设置为指定的内容--&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:text</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;hello&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:utext</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;hello&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> //utext不会转移</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!--th:each=""每次遍历都会生成当前这个标签 3个h4--&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h4</span> <span class="attr">th:text</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;user&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">th:each</span>=<span class="string">"user:$</span></span></span><span class="template-variable">&#123;users&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="comment">&lt;!----&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:each</span>=<span class="string">"user:$</span></span></span><span class="template-variable">&#123;users&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>[[$</span><span class="template-variable">&#123;user&#125;</span><span class="xml">]]<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li>
<li>2.Controllor控制层<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> &#123;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*    @RequestMapping(&#123;"/","/login.html"&#125;)</span></span><br><span class="line"><span class="comment">    public String index()&#123;</span></span><br><span class="line"><span class="comment">        return "login";</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    @ResponseBody</span><br><span class="line">    @RequestMapping(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello world!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查出一些数据在页面显示</span></span><br><span class="line">    @RequestMapping(<span class="string">"/success"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">String</span> <span class="title">success</span><span class="params">(Map&lt;<span class="keyword">String</span>,Object&gt; <span class="built_in">map</span>)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">map</span>.<span class="built_in">put</span>(<span class="string">"hello"</span>,<span class="string">"&lt;h1&gt;你好！&lt;/h1&gt;"</span>);</span><br><span class="line">        <span class="built_in">map</span>.<span class="built_in">put</span>(<span class="string">"users"</span>,Arrays.asList(<span class="string">"沐沐"</span>,<span class="string">"离奇"</span>,<span class="string">"哈克"</span>));</span><br><span class="line">        <span class="comment">//classpath:/templates/success.html</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="如何修改SpringBoot的默认配置"><a href="#如何修改SpringBoot的默认配置" class="headerlink" title="如何修改SpringBoot的默认配置"></a>如何修改SpringBoot的默认配置</h3></li>
<li>模式：<ol>
<li>SpringBoot在容器中自动配置很多组件的时候，先看容器中有没有用户自己配（@bean，@Component），如果有就用用户配置的，如果没有，才自动配置；如果有些组件可以有多个（ViewResolver，视图解析器）将用户配置的和SpringBoot默认配置的组合起来</li>
<li><h3 id="扩展SprinMVC"><a href="#扩展SprinMVC" class="headerlink" title="扩展SprinMVC"></a>扩展SprinMVC</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:view-controller</span> <span class="attr">path</span>=<span class="string">"/hello"</span> <span class="attr">view-name</span>=<span class="string">"success"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/hello"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">hean</span>&gt;</span><span class="tag">&lt;<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li>编写一个配置类（@Configuration），是WebMvcConfigurer类型，不能标注@EnableWebMvc</li>
<li>如果标注了@EnableWebMvc表示SpringBoot所有的配置类都不要了，所有的都是我们自己的配置，全面接管SpringMvc</li>
<li>特点：既保留了所有的自动配置，也能用我们的扩展</li>
<li>在SpringBoot中会有很多xxxConfigurer(如webMvcConfigurer)</li>
<li>注意：快捷键ctrl+o 弹出父类的所有方法<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用WebMvcConfigurer扩展SpringMvc的功能</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span>   </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//浏览器发送/zhao请求 也来到success页面</span></span><br><span class="line">    registry.addViewController(<span class="string">"/zhao"</span>).setViewName(<span class="string">"success"</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>原理：<ul>
<li>WebMvcAutoConfiguration是SpringMvc的自动配置类</li>
<li>在做其他配置时会导入：@import(EnablewebMvcConfiguration.class)<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Configuration</span>(</span><br><span class="line">  proxyBeanMethods = <span class="keyword">false</span></span><br><span class="line">   )</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">EnableWebMvcConfiguration</span> <span class="keyword">extends</span>    <span class="title">DelegatingWebMvcConfiguration</span> <span class="keyword">implements</span> <span class="title">ResourceLoaderAware</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">EnableWebMvcConfiguration</span><span class="params">(ResourceProperties resourceProperties, ObjectProvider&lt;WebMvcProperties&gt; mvcPropertiesProvider, ObjectProvider&lt;WebMvcRegistrations&gt; mvcRegistrationsProvider, ListableBeanFactory beanFactory)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.resourceProperties = resourceProperties;</span><br><span class="line">      <span class="keyword">this</span>.mvcProperties = (WebMvcProperties)mvcPropertiesProvider.getIfAvailable();</span><br><span class="line">      <span class="keyword">this</span>.mvcRegistrations = (WebMvcRegistrations)mvcRegistrationsProvider.getIfUnique();</span><br><span class="line">      <span class="keyword">this</span>.beanFactory = beanFactory;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//从容器中获取所有的WebMvcConfigurer</span></span><br><span class="line"> <span class="meta">@Autowired</span>(</span><br><span class="line">  required = <span class="keyword">false</span></span><br><span class="line">   )</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setConfigurers</span><span class="params">(List&lt;WebMvcConfigurer&gt; configurers)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!CollectionUtils.isEmpty(configurers)) &#123;</span><br><span class="line">      <span class="keyword">this</span>.configurers.addWebMvcConfigurers(configurers);</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li>
<li>容器中所有的WebmvcConfigurer都会自己其作用用</li>
<li>我们配置也会起作用</li>
<li>效果：SpringMVC的自己起作用和我们的配置也会起作用</li>
<li>@EnableWebMvcConfigurationSupport组件导入进来；</li>
<li>导入的WebMvcConfigurationSupport只是SpringMvc最基本的功能；<h3 id="加载首页方法"><a href="#加载首页方法" class="headerlink" title="加载首页方法"></a>加载首页方法</h3></li>
</ul>
</li>
</ul>
</li>
<li><p>1.Controller写的方法</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&#123;<span class="meta-string">"/"</span>,<span class="meta-string">"/login.html"</span>&#125;)</span></span><br><span class="line">   <span class="keyword">public</span> String index()&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"login"</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>2.自己写配置类继承WebMvcConfigurer类</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//所有的WebMvcConfigurer组件都会起作用</span></span><br><span class="line">   <span class="meta">@Bean</span> <span class="comment">//把组件加入到容器中</span></span><br><span class="line">   <span class="keyword">public</span> <span class="function">WebMvcConfigurer <span class="title">webMvcConfigurer</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">       WebMvcConfigurer config = <span class="keyword">new</span> WebMvcConfigurer() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> </span>&#123;</span><br><span class="line">               registry.addViewController(<span class="string">"/"</span>).setViewName(<span class="string">"login"</span>);</span><br><span class="line">               registry.addViewController(<span class="string">"/login.html"</span>).setViewName(<span class="string">"login"</span>);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">       &#125;;</span><br><span class="line">       <span class="keyword">return</span> config;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h4 id="通过Webjars方式加入boootstrap"><a href="#通过Webjars方式加入boootstrap" class="headerlink" title="通过Webjars方式加入boootstrap"></a>通过Webjars方式加入boootstrap</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">通过webjars官网找到bootstrap添加到Maven依赖</span><br><span class="line"><span class="comment">&lt;!--引入Bootstrop--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.webjars<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="通过模板引擎引入外部文件"><a href="#通过模板引擎引入外部文件" class="headerlink" title="通过模板引擎引入外部文件"></a>通过模板引擎引入外部文件</h4><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="comment">&lt;!-- Bootstrap core CSS --&gt;</span></span></span><br><span class="line"><span class="xml">	<span class="comment">&lt;!--Webjars方式引入bootstaap.css文件</span></span></span><br><span class="line"><span class="xml">	第一部导入Maven依赖--&gt;</span></span><br><span class="line"><span class="xml">	<span class="comment">&lt;!--引入CSS等外部文件 th:href="@</span></span><span class="template-tag">&#123;/<span class="name">webjars</span>/bootstrap/4.0.0/css/bootstrap.css&#125;</span><span class="xml"><span class="comment">"--&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"asserts/css/bootstrap.min.css"</span> <span class="attr">th:href</span>=<span class="string">"@</span></span></span><span class="template-tag">&#123;/<span class="name">webjars</span>/bootstrap/4.0.0/css/bootstrap.css&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"asserts/css/signin.css"</span>  <span class="attr">th:href</span>=<span class="string">"@</span></span></span><span class="template-variable">&#123;asserts/css/signin.css&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"mb-4"</span> <span class="attr">src</span>=<span class="string">"asserts/img/bootstrap-solid.svg"</span> <span class="attr">th:src</span>=<span class="string">"@</span></span></span><span class="template-variable">&#123;asserts/img/bootstrap-solid.svg&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">alt</span>=<span class="string">""</span> <span class="attr">width</span>=<span class="string">"72"</span> <span class="attr">height</span>=<span class="string">"72"</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h4 id="国际化"><a href="#国际化" class="headerlink" title="国际化"></a>国际化</h4></li>
<li><p>SpringMvc使用过程</p>
<ul>
<li>1.编写国际化配置文件</li>
<li>2.使用ResourceBundleMessageSource管理国际化资源</li>
<li>3.在页面使用fmt:message去除国际化内容</li>
</ul>
</li>
<li><p>SpringBoot配置</p>
<ul>
<li><p>步骤：</p>
<ul>
<li>1.编写国际化配置文件，抽取页面需要显示的内容(创建i18n文件夹，创建默认显示文件login.properties,中文状态显示文件login_zh_CN.properties,英文状态下显示文件login_en_US.properties)在创建中文状态显示的文件，可以快捷方式创建(New –&gt;Add Property File)</li>
<li>2.显示内容通过页面Resource Bulid进行创建 属性=值的方式</li>
<li>3.SpringBoot已经自动配置好了管理国际化资源文件的组件</li>
<li>4.application.properties文件中配置spring.messages.basename=i18n.login<br>源码：<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(</span><br><span class="line">   prefix = <span class="string">"spring.messages"</span></span><br><span class="line">)</span><br><span class="line"> <span class="comment">//我们的配置文件可以直接放在类路径下加message.properties;</span></span><br><span class="line"><span class="keyword">public</span> <span class="function">MessageSourceProperties <span class="title">messageSourceProperties</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="keyword">new</span> MessageSourceProperties();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> <span class="function">MessageSource <span class="title">messageSource</span><span class="params">(MessageSourceProperties properties)</span> </span>&#123;</span><br><span class="line">   ResourceBundleMessageSource messageSource = <span class="keyword">new</span> ResourceBundleMessageSource();</span><br><span class="line">   <span class="keyword">if</span> (StringUtils.hasText(properties.getBasename())) &#123;</span><br><span class="line">     <span class="comment">//设置国际化资源文件的基础名（去掉语言国家的代码）</span></span><br><span class="line">       messageSource.setBasenames(StringUtils.commaDelimitedListToStringArray(StringUtils.trimAllWhitespace(properties.getBasename())));</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> (properties.getEncoding() != <span class="keyword">null</span>) &#123;</span><br><span class="line">       messageSource.setDefaultEncoding(properties.getEncoding().name());</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></li>
<li>去页面获取国际化的值th:text=”#{login.tip}”<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE html&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span> &gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1, shrink-to-fit=no"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"description"</span> <span class="attr">content</span>=<span class="string">""</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"author"</span> <span class="attr">content</span>=<span class="string">""</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Signin Template for Bootstrap<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- Bootstrap core CSS --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!--Webjars方式引入bootstaap.css文件</span></span></span><br><span class="line"><span class="xml">    第一部导入Maven依赖--&gt;</span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!--引入CSS等外部文件 th:href="@</span></span><span class="template-tag">&#123;/<span class="name">webjars</span>/bootstrap/4.0.0/css/bootstrap.css&#125;</span><span class="xml"><span class="comment">"--&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"asserts/css/bootstrap.min.css"</span> <span class="attr">th:href</span>=<span class="string">"@</span></span></span><span class="template-tag">&#123;/<span class="name">webjars</span>/bootstrap/4.0.0/css/bootstrap.css&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!-- Custom styles for this template --&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"asserts/css/signin.css"</span>  <span class="attr">th:href</span>=<span class="string">"@</span></span></span><span class="template-variable">&#123;asserts/css/signin.css&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-signin"</span> <span class="attr">action</span>=<span class="string">"dashboard.html"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">"mb-4"</span> <span class="attr">src</span>=<span class="string">"asserts/img/bootstrap-solid.svg"</span> <span class="attr">th:src</span>=<span class="string">"@</span></span></span><span class="template-variable">&#123;asserts/img/bootstrap-solid.svg&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">alt</span>=<span class="string">""</span> <span class="attr">width</span>=<span class="string">"72"</span> <span class="attr">height</span>=<span class="string">"72"</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"h3 mb-3 font-weight-normal"</span> <span class="attr">th:text</span>=<span class="string">"#</span></span></span><span class="template-variable">&#123;login.tip&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>Please sign in<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"sr-only"</span> <span class="attr">th:text</span>=<span class="string">"#</span></span></span><span class="template-variable">&#123;login.username&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>Username<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"Username"</span> <span class="attr">th:placeholder</span>=<span class="string">"#</span></span></span><span class="template-variable">&#123;login.username&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">required</span>=<span class="string">""</span> <span class="attr">autofocus</span>=<span class="string">""</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"sr-only"</span> <span class="attr">th:text</span>=<span class="string">"#</span></span></span><span class="template-variable">&#123;login.password&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>Password<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">placeholder</span>=<span class="string">"Password"</span> <span class="attr">th:placeholder</span>=<span class="string">"#</span></span></span><span class="template-variable">&#123;login.password&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">required</span>=<span class="string">""</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"checkbox mb-3"</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="comment">&lt;!-- 注意此处单选框 --&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">value</span>=<span class="string">"remember-me"</span>&gt;</span> [[#</span><span class="template-variable">&#123;login.Remember&#125;</span><span class="xml">]]</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-lg btn-primary btn-block"</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">th:text</span>=<span class="string">"#</span></span></span><span class="template-variable">&#123;login.btn&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>Sign in<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"mt-5 mb-3 text-muted"</span>&gt;</span>© 2017-2018<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-sm"</span>&gt;</span>中文<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-sm"</span>&gt;</span>English<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li>
<li>效果：根据浏览器语言设置信息切换国际化</li>
</ul>
<ul>
<li>国际化Locale(区域信息对象)；LocaleResolver</li>
<li>源码<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//区域信息解析器</span></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">  <span class="meta">@ConditionalOnProperty(</span></span><br><span class="line"><span class="meta">      prefix = <span class="meta-string">"spring.mvc"</span>,</span></span><br><span class="line"><span class="meta">      name = &#123;<span class="meta-string">"locale"</span>&#125;</span></span><br><span class="line"><span class="meta">  )</span></span><br><span class="line">  <span class="keyword">public</span> LocaleResolver localeResolver() &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.mvcProperties.getLocaleResolver() == org.springframework.boot.autoconfigure.web.servlet.WebMvcProperties.LocaleResolver.FIXED) &#123;</span><br><span class="line">          <span class="keyword">return</span> new FixedLocaleResolver(<span class="keyword">this</span>.mvcProperties.getLocale());</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          AcceptHeaderLocaleResolver localeResolver = new AcceptHeaderLocaleResolver();</span><br><span class="line">          localeResolver.setDefaultLocale(<span class="keyword">this</span>.mvcProperties.getLocale());</span><br><span class="line">          <span class="keyword">return</span> localeResolver;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  默认的就是根据请求头带来的区域性息获取Locale进行国际化</span><br></pre></td></tr></table></figure></li>
<li>自定义区域信息解析器</li>
</ul>
<ul>
<li>1.html添加访问路径<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"> 	<span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-sm"</span> <span class="attr">th:href</span>=<span class="string">"@</span></span></span><span class="template-tag">&#123;/<span class="name">login.html</span>(L='zh_CN')&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>中文<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-sm"</span> <span class="attr">th:href</span>=<span class="string">"@</span></span></span><span class="template-tag">&#123;/<span class="name">login.html</span>(L='en_US')&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>English<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li>
<li>2.创建MyLocaleResolver继承LocaleResolver  //区域信息解析器<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">  import org.springframework.util.StringUtils;</span><br><span class="line">  import org.springframework.web.servlet.LocaleResolver;</span><br><span class="line"></span><br><span class="line">  import javax.servlet.http.HttpServletRequest;</span><br><span class="line">  import javax.servlet.http.HttpServletResponse;</span><br><span class="line">  import java.util.Locale;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  * 可以在链接上携带上区域信息</span></span><br><span class="line"><span class="comment">  * */</span></span><br><span class="line"> public <span class="keyword">class</span> MyLocaleResolver implements LocaleResolver &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*解析区域性息*/</span></span><br><span class="line">    @Override</span><br><span class="line">    public Locale resolve<span class="constructor">Locale(HttpServletRequest <span class="params">httpServletRequest</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        String L = httpServletRequest.get<span class="constructor">Parameter(<span class="string">"L"</span>)</span>;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(L);</span><br><span class="line"></span><br><span class="line">        Locale locale = <span class="module-access"><span class="module"><span class="identifier">Locale</span>.</span></span>get<span class="constructor">Default()</span>;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(locale);</span><br><span class="line">        <span class="comment">//注意此处判断条件！StringUtils.isEmplaty(L) 不为空</span></span><br><span class="line">        <span class="keyword">if</span>(!<span class="module-access"><span class="module"><span class="identifier">StringUtils</span>.</span></span>is<span class="constructor">Empty(L)</span>)&#123;</span><br><span class="line">          String<span class="literal">[]</span> split = <span class="module-access"><span class="module"><span class="identifier">L</span>.</span></span>split(<span class="string">"_"</span>);</span><br><span class="line">          <span class="comment">//注意此处为变量，不是字符串</span></span><br><span class="line">          locale = <span class="keyword">new</span> <span class="constructor">Locale(<span class="params">split</span>[0],<span class="params">split</span>[1])</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>out.println(locale);</span><br><span class="line">        return locale;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void set<span class="constructor">Locale(HttpServletRequest <span class="params">httpServletRequest</span>, HttpServletResponse <span class="params">httpServletResponse</span>, Locale <span class="params">locale</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>3.在配置类中将自定义的MyLocaleResolver加入Springboot容器中<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> <span class="function">LocaleResolver <span class="title">localeResolver</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MyLocaleResolver();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>5.效果：可根据页面链接转换语言信息，此时浏览器的语言选择 对其不起作用<h3 id="开发技巧ctrl-F9重新编译"><a href="#开发技巧ctrl-F9重新编译" class="headerlink" title="开发技巧ctrl+F9重新编译"></a>开发技巧ctrl+F9重新编译</h3></li>
</ul>
</li>
</ul>
</li>
<li><p>开发期间模板引擎页面修改之后，要实时生效</p>
<ul>
<li>1.application.properties禁用模板引擎的缓存<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#禁用模板引擎的缓存</span></span><br><span class="line"><span class="attr">pring.thymeleaf.cache</span>=<span class="literal">false</span></span><br></pre></td></tr></table></figure></li>
<li>2.页面修改后ctrl+F9重新编译<h4 id="错误消息显示及判断"><a href="#错误消息显示及判断" class="headerlink" title="错误消息显示及判断"></a>错误消息显示及判断</h4><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="comment">&lt;!--判断msg是否为空，后执行text标签内容 此处if标签优先级高于text标签优先级  --&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"color: red"</span> <span class="attr">th:text</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;msg&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">th:if</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;not #strings.isEmpty(msg)&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h3 id="拦截器机制进行登陆检查"><a href="#拦截器机制进行登陆检查" class="headerlink" title="拦截器机制进行登陆检查"></a>拦截器机制进行登陆检查</h3></li>
</ul>
</li>
<li><p>1.创建拦截器对象实现HandlerInterceptor接口</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 登陆检查,拦截器</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginHandlerInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*目标方法执行之前*/</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object <span class="keyword">handler</span>)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        Object user = request.getSession().getAttribute(<span class="string">"loginUser"</span>);</span><br><span class="line">        <span class="keyword">if</span>(user == <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="comment">//未登录，返回登陆界面</span></span><br><span class="line">            request.setAttribute(<span class="string">"msg"</span>,<span class="string">"没有权限请先登录"</span>);</span><br><span class="line">            request.getRequestDispatcher(<span class="string">"/login.html"</span>).forward(request,response);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//已登录，放行请求</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object <span class="keyword">handler</span>, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object <span class="keyword">handler</span>, Exception ex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>2.将拦截器对象加载到配置类容器中</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//注册拦截器</span></span><br><span class="line">          @Override</span><br><span class="line">          public void add<span class="constructor">Interceptors(InterceptorRegistry <span class="params">registry</span>)</span> &#123;</span><br><span class="line">              <span class="comment">//静态资源；*.css , *.js</span></span><br><span class="line">              <span class="comment">//SpringBoot已经做好了静态资源映射</span></span><br><span class="line">              registry.add<span class="constructor">Interceptor(<span class="params">new</span> LoginHandlerInterceptor()</span>).add<span class="constructor">PathPatterns(<span class="string">"/**"</span>)</span>.</span><br><span class="line">                      exclude<span class="constructor">PathPatterns(<span class="string">"/login.html"</span>,<span class="string">"/"</span>,<span class="string">"/user/login"</span>)</span>;</span><br><span class="line">          &#125;</span><br></pre></td></tr></table></figure>
<h3 id="CRUD操作——员工列表"><a href="#CRUD操作——员工列表" class="headerlink" title="CRUD操作——员工列表"></a>CRUD操作——员工列表</h3></li>
</ul>
<h3 id="模板引擎Thymeleaf公共页面元素抽取"><a href="#模板引擎Thymeleaf公共页面元素抽取" class="headerlink" title="模板引擎Thymeleaf公共页面元素抽取"></a>模板引擎Thymeleaf公共页面元素抽取</h3><ul>
<li>1.抽取公共片段 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span>     </span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:fragment</span>=<span class="string">"copy"</span>&gt;</span>     </span><br><span class="line">    &amp;copy; 2011 The Good Thymes Virtual Grocery   </span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span>    </span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>2.引入公共模块<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:insert</span>=<span class="string">"~</span></span></span><span class="template-variable">&#123;footer :: copy&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span></span><br><span class="line"><span class="xml">~</span><span class="template-variable">&#123;templatename::selector&#125;</span><span class="xml">:模块名：：片段名</span></span><br><span class="line"><span class="xml">~</span><span class="template-variable">&#123;templatename：：fragmentname&#125;</span><span class="xml">：模块名：：片段名</span></span><br></pre></td></tr></table></figure></li>
<li>3.默认效果 insert的功能片段在div标签里</li>
<li>4.注意：如果使用th:insert等属性进行引入，可以不用写<del>{};<br>行内写法必须写</del>{}方式 [[~{}]];<h3 id="三种引入功能片段的th-属性"><a href="#三种引入功能片段的th-属性" class="headerlink" title="三种引入功能片段的th:属性"></a>三种引入功能片段的th:属性</h3></li>
<li>1.th:insert   :将公共的片段整个插入到声明引入的元素里面</li>
<li>2.th:replace  ：将声明引入的元素替换为公共片段</li>
<li>3.th:include  ：将被引入的片段的内容包含进这个标签中<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">footer</span> <span class="attr">th:fragment</span>=<span class="string">"copy"</span>&gt;</span></span><br><span class="line">  &amp;copy; 2011 The Good Thymes Virtual Grocery</span><br><span class="line"><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:insert</span>=<span class="string">"footer :: copy"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">"footer :: copy"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:include</span>=<span class="string">"footer :: copy"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>    </span><br><span class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span>     </span><br><span class="line">    &amp;copy; 2011 The Good Thymes Virtual Grocery    </span><br><span class="line">  <span class="tag">&lt;/<span class="name">footer</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span>&gt;</span>   </span><br><span class="line">    &amp;copy; 2011 The Good Thymes Virtual Grocery  </span><br><span class="line"> <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>   </span><br><span class="line">   &amp;copy; 2011 The Good Thymes Virtual Grocery  </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="模板引擎使用的一些小技巧"><a href="#模板引擎使用的一些小技巧" class="headerlink" title="模板引擎使用的一些小技巧"></a>模板引擎使用的一些小技巧</h3></li>
<li>1.th:if=”” 通过三目运算的判断改变其样式<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="comment">&lt;!--引入侧边栏--&gt;</span></span></span><br><span class="line"><span class="xml"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">th:replace</span>=<span class="string">"commons/bar::#sidebar(activeUri='emps')"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  th:class="$</span><span class="template-variable">&#123;activeUri=='emps'?'nav-link active':'nav-link'&#125;</span><span class="xml">"</span></span><br></pre></td></tr></table></figure></li>
<li>2.Thymeleaf日期格式的转换<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;td&gt;<span class="string">[[$&#123;#dates.format(emp.birth, 'yyyy-MM-dd HH:mm')&#125;]]</span>&lt;/td&gt;</span><br></pre></td></tr></table></figure></li>
<li>3.bootstrap前端框架button按钮样式小技巧<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">通过添加class选择器 <span class="keyword">btn </span><span class="keyword">btn-sm </span><span class="keyword">btn-颜色 </span> </span><br><span class="line"> eg： &lt;<span class="keyword">button </span>class=<span class="string">"btn btb-sm btn-danger"</span>&gt;删除&lt;/<span class="keyword">button&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>4.行内Teymeleaf表达式的写法[()]表示转义 [[]]不转义<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;td&gt;<span class="string">[[$&#123;emp.department.departmentName&#125;]]</span>&lt;/td&gt;</span><br><span class="line">&lt;td&gt;<span class="string">[[$&#123;#dates.format(emp.birth, 'yyyy-MM-dd HH:mm')&#125;]]</span>&lt;/td&gt;</span><br></pre></td></tr></table></figure></li>
<li>5.Teymeleaf表达式做三目运算最好将其写在{}大括号外面<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$</span></span></span><span class="template-variable">&#123;emp.gender&#125;</span><span class="xml"><span class="tag"><span class="string">==0?'女':'男'"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li>
<li>6.遍历集合只需在标签内部加入th:each=””即可<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">tr</span> th:<span class="keyword">each</span>=<span class="string">"emp:<span class="subst">$&#123;emps&#125;</span>"</span>&gt;</span><br></pre></td></tr></table></figure></li>
<li>7.controller层操作<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">  <span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    EmployeeDao employeeDao;</span><br><span class="line">     </span><br><span class="line">    <span class="comment">//查询所偶员工列表页面</span></span><br><span class="line">    <span class="meta">@GetMapping(<span class="meta-string">"/emps"</span>)</span></span><br><span class="line">    <span class="keyword">public</span> String list(Model model)&#123;</span><br><span class="line"></span><br><span class="line">        Collection&lt;Employee&gt; employees = employeeDao.getAll();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//放在请求域中进行共享</span></span><br><span class="line">        model.addAttribute(<span class="string">"emps"</span>,employees);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//thymeleaf（模板引擎）默认就会拼串到类路径下classpath:/templates/...html</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"emp/list"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Controller层增删改查"><a href="#Controller层增删改查" class="headerlink" title="Controller层增删改查"></a>Controller层增删改查</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmployeeController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   EmployeeDao employeeDao;</span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   DepartmentDao departmentDao;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//查询所偶员工列表页面</span></span><br><span class="line">   <span class="meta">@GetMapping(<span class="meta-string">"/emps"</span>)</span></span><br><span class="line">   <span class="keyword">public</span> String list(Model model)&#123;</span><br><span class="line"></span><br><span class="line">       Collection&lt;Employee&gt; employees = employeeDao.getAll();</span><br><span class="line"></span><br><span class="line">       <span class="comment">//放在请求域中进行共享</span></span><br><span class="line">       model.addAttribute(<span class="string">"emps"</span>,employees);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//thymeleaf（模板引擎）默认就会拼串到类路径下classpath:/templates/...html</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">"emp/list"</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//来到与员工添加页面</span></span><br><span class="line">   <span class="meta">@GetMapping(<span class="meta-string">"/emp"</span>)</span></span><br><span class="line">   <span class="keyword">public</span> String toAddPage(Model model)&#123;</span><br><span class="line">       <span class="comment">//来到所有页面,查出所有的部门，在页面显示</span></span><br><span class="line">       Collection&lt;Department&gt; departments = departmentDao.getDepartments();</span><br><span class="line">       model.addAttribute(<span class="string">"depts"</span>,departments);</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"emp/add"</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="comment">//员工添加功能</span></span><br><span class="line">   <span class="comment">//SpringMvc自动将请求参数和入参的对象的属性进一一绑定；要求请求参数的名字和参数的名字和JavaBean入参的对象里面的属性名</span></span><br><span class="line">   <span class="meta">@PostMapping(<span class="meta-string">"/emp"</span>)</span></span><br><span class="line">   <span class="keyword">public</span> String addEmp(Employee employee01)&#123;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//来到员工列表页面</span></span><br><span class="line">       System.<span class="keyword">out</span>.println(<span class="string">"保存员工信息："</span>+employee01);</span><br><span class="line">       <span class="comment">//保存员工</span></span><br><span class="line">       employeeDao.save(employee01);</span><br><span class="line">       <span class="comment">//redirect:表示重定向，到一个地址</span></span><br><span class="line">       <span class="comment">//forword：表示转发到一个地址</span></span><br><span class="line">       <span class="comment">//  /表示当前项目路径你</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">"redirect:/emps"</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//@PathVariable("id") 获取路径变量</span></span><br><span class="line">   <span class="comment">//来到修改页面，查出当前员工，在页面回显</span></span><br><span class="line">   <span class="meta">@GetMapping(<span class="meta-string">"/emp/&#123;id&#125;"</span>)</span></span><br><span class="line">   <span class="keyword">public</span> String toEditPage(<span class="meta">@PathVariable(<span class="meta-string">"id"</span>)</span> Integer id,Model model)&#123;</span><br><span class="line"></span><br><span class="line">       Employee employee = employeeDao.<span class="keyword">get</span>(id);</span><br><span class="line">       model.addAttribute(<span class="string">"emp"</span>,employee);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//来到所有页面,查出所有的部门，在页面显示</span></span><br><span class="line">       Collection&lt;Department&gt; departments = departmentDao.getDepartments();</span><br><span class="line">       model.addAttribute(<span class="string">"depts"</span>,departments);</span><br><span class="line">       <span class="comment">//回到修改页面</span></span><br><span class="line">       <span class="keyword">return</span> <span class="string">"emp/add"</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//员工修改,需要提交员工id</span></span><br><span class="line">   <span class="meta">@PutMapping(<span class="meta-string">"/emp"</span>)</span></span><br><span class="line">   <span class="keyword">public</span> String updateEmp(Employee employee)&#123;</span><br><span class="line">       System.<span class="keyword">out</span>.println(<span class="string">"修改数据:"</span>+employee);</span><br><span class="line">       employeeDao.save(employee);</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"redirect:/emps"</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//员工删除</span></span><br><span class="line">   <span class="meta">@DeleteMapping(<span class="meta-string">"/emp/&#123;id&#125;"</span>)</span> <span class="comment">//@PathVariable("id") 获取路径变量</span></span><br><span class="line">   <span class="keyword">public</span> String deleteEmp(<span class="meta">@PathVariable(<span class="meta-string">"id"</span>)</span> Integer id)&#123;</span><br><span class="line">       employeeDao.delete(id);</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"redirect:/emps"</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="配置类"><a href="#配置类" class="headerlink" title="配置类"></a>配置类</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">package com.zhao.democrud.config;</span><br><span class="line"></span><br><span class="line">import com.zhao.democrud.componennt.LoginHandlerInterceptor;</span><br><span class="line">import com.zhao.democrud.componennt.MyLocaleResolver;</span><br><span class="line">import org.springframework.context.<span class="keyword">annotation</span>.<span class="title">Bean</span>;</span><br><span class="line">import org.springframework.context.<span class="keyword">annotation</span>.<span class="title">Configuration</span>;</span><br><span class="line">import org.springframework.web.servlet.LocaleResolver;</span><br><span class="line">import org.springframework.web.servlet.config.<span class="keyword">annotation</span>.<span class="title">InterceptorRegistry</span>;</span><br><span class="line">import org.springframework.web.servlet.config.<span class="keyword">annotation</span>.<span class="title">ViewControllerRegistry</span>;</span><br><span class="line">import org.springframework.web.servlet.config.<span class="keyword">annotation</span>.<span class="title">WebMvcConfigurer</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/<span class="regexp">/使用WebMvcConfigurer扩展SpringMvc的功能</span></span><br><span class="line"><span class="regexp">@Configuration</span></span><br><span class="line"><span class="regexp">public class MyMvcConfig implements WebMvcConfigurer &#123;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    @Override</span></span><br><span class="line"><span class="regexp">    public void addViewControllers(ViewControllerRegistry registry) &#123;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        /</span><span class="regexp">/浏览器发送/zhao</span>请求 也来到success页面</span><br><span class="line">        registry.addViewController(<span class="string">"/zhao"</span>).setViewName(<span class="string">"success"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /<span class="regexp">/所有的WebMvcConfigurer组件都会起作用</span></span><br><span class="line"><span class="regexp">    @Bean /</span><span class="regexp">/把组件加入到容器中</span></span><br><span class="line"><span class="regexp">    public WebMvcConfigurer webMvcConfigurer()&#123;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        WebMvcConfigurer config = new WebMvcConfigurer() &#123;</span></span><br><span class="line"><span class="regexp">            @Override</span></span><br><span class="line"><span class="regexp">            public void addViewControllers(ViewControllerRegistry registry) &#123;</span></span><br><span class="line"><span class="regexp">                registry.addViewController("/</span><span class="string">").setViewName("</span>login<span class="string">");</span></span><br><span class="line"><span class="string">                registry.addViewController("</span>/login.html<span class="string">").setViewName("</span>login<span class="string">");</span></span><br><span class="line"><span class="string">                registry.addViewController("</span>/main.html<span class="string">").setViewName("</span>dashboard<span class="string">");</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            //注册拦截器</span></span><br><span class="line"><span class="string">            @Override</span></span><br><span class="line"><span class="string">            public void addInterceptors(InterceptorRegistry registry) &#123;</span></span><br><span class="line"><span class="string">                //静态资源；*.css , *.js</span></span><br><span class="line"><span class="string">                //SpringBoot已经做好了静态资源映射</span></span><br><span class="line"><span class="string">                registry.addInterceptor(new LoginHandlerInterceptor()).addPathPatterns("</span>/**<span class="string">").</span></span><br><span class="line"><span class="string">                        excludePathPatterns("</span>/login.html<span class="string">","</span>/<span class="string">","</span>/user/login<span class="string">");</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125;;</span></span><br><span class="line"><span class="string">        return config;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    @Bean</span></span><br><span class="line"><span class="string">    public LocaleResolver localeResolver()&#123;</span></span><br><span class="line"><span class="string">        return new MyLocaleResolver();</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>感谢关顾！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/qrcode.png" alt="卓尔不凡 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/zgub.jpg" alt="卓尔不凡 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/SpringBoot/" rel="tag"><i class="fab fa-behance-square"></i> SpringBoot</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/12/28/SpringBoot%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6-%E4%BA%8C-%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3/" rel="next" title="SpringBoot微服务框架(二)--自动配置详解">
                <i class="fa fa-chevron-left"></i> SpringBoot微服务框架(二)--自动配置详解
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/01/08/SpringBoot%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6-%E5%9B%9B/" rel="prev" title="SpringBoot微服务框架(四)">
                SpringBoot微服务框架(四) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      
        <div onclick="showGitment()" id="gitment-display-button">显示 Gitment 评论</div>
        <div id="gitment-container" style="display:none"></div>
      
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.gif"
                alt="卓尔不凡" />
            
              <p class="site-author-name" itemprop="name">卓尔不凡</p>
              <p class="site-description motion-element" itemprop="description">你我暮年，闲坐庭院， 云卷云舒听雨声，星密星稀赏月影， 花开花落忆江南， 你话往时，我画往事， 愿有岁月可回首，且以深情共白头</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/botbotji" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://mail.qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#配置debug-true，控制台打印自动配置报告"><span class="nav-number">1.</span> <span class="nav-text">配置debug=true，控制台打印自动配置报告</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#日志"><span class="nav-number">2.</span> <span class="nav-text">日志</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#日志框架"><span class="nav-number">2.1.</span> <span class="nav-text">日志框架</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#slf4j的使用"><span class="nav-number">3.</span> <span class="nav-text">slf4j的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#如何在系统中所有的日志都统一到slf4j；"><span class="nav-number">3.0.1.</span> <span class="nav-text">如何在系统中所有的日志都统一到slf4j；</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#springBoot日志关系"><span class="nav-number">4.</span> <span class="nav-text">springBoot日志关系</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#测试案例"><span class="nav-number">4.1.</span> <span class="nav-text">测试案例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#指定日志的输出位置"><span class="nav-number">5.</span> <span class="nav-text">指定日志的输出位置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#日志的输出格式："><span class="nav-number">6.</span> <span class="nav-text">日志的输出格式：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#切换日志框架"><span class="nav-number">7.</span> <span class="nav-text">切换日志框架</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web开发"><span class="nav-number">8.</span> <span class="nav-text">web开发</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#静态文件夹配置"><span class="nav-number">9.</span> <span class="nav-text">静态文件夹配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#模板引擎Thymeleaf"><span class="nav-number">10.</span> <span class="nav-text">模板引擎Thymeleaf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Html文件位置在templates文件夹下"><span class="nav-number">11.</span> <span class="nav-text">Html文件位置在templates文件夹下</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#案例"><span class="nav-number">12.</span> <span class="nav-text">案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何修改SpringBoot的默认配置"><span class="nav-number">13.</span> <span class="nav-text">如何修改SpringBoot的默认配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#扩展SprinMVC"><span class="nav-number">14.</span> <span class="nav-text">扩展SprinMVC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#加载首页方法"><span class="nav-number">15.</span> <span class="nav-text">加载首页方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#通过Webjars方式加入boootstrap"><span class="nav-number">15.1.</span> <span class="nav-text">通过Webjars方式加入boootstrap</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#通过模板引擎引入外部文件"><span class="nav-number">15.2.</span> <span class="nav-text">通过模板引擎引入外部文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#国际化"><span class="nav-number">15.3.</span> <span class="nav-text">国际化</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#开发技巧ctrl-F9重新编译"><span class="nav-number">16.</span> <span class="nav-text">开发技巧ctrl+F9重新编译</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#错误消息显示及判断"><span class="nav-number">16.1.</span> <span class="nav-text">错误消息显示及判断</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#拦截器机制进行登陆检查"><span class="nav-number">17.</span> <span class="nav-text">拦截器机制进行登陆检查</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CRUD操作——员工列表"><span class="nav-number">18.</span> <span class="nav-text">CRUD操作——员工列表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#模板引擎Thymeleaf公共页面元素抽取"><span class="nav-number">19.</span> <span class="nav-text">模板引擎Thymeleaf公共页面元素抽取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三种引入功能片段的th-属性"><span class="nav-number">20.</span> <span class="nav-text">三种引入功能片段的th:属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#模板引擎使用的一些小技巧"><span class="nav-number">21.</span> <span class="nav-text">模板引擎使用的一些小技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Controller层增删改查"><span class="nav-number">21.1.</span> <span class="nav-text">Controller层增删改查</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置类"><span class="nav-number">22.</span> <span class="nav-text">配置类</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">卓尔不凡</span>

  
</div>

<!--
  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>
-->



        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  







  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.4"></script>



  

  

  

  
  

  

  

  

  
  
</body>
</html>
